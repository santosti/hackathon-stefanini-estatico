function PessoaIncluirAlterarController(a,b,c,d,e,f,g){vm=this,vm.pessoa={id:null,imagem:"",nome:"",email:"",dataNascimento:null,enderecos:[],perfils:[],situacao:!1},vm.enderecoDefault={id:null,idPessoa:null,cep:"",uf:"",localidade:"",bairro:"",logradouro:"",complemento:""},vm.urlEndereco="http://localhost:8080/treinamento/api/enderecos/",vm.urlPerfil="http://localhost:8080/treinamento/api/perfils/",vm.urlPessoa="http://localhost:8080/treinamento/api/pessoas/",vm.urlObterEnderecoPorCep="http://localhost:8080/treinamento/api/cep/",vm.init=function(){vm.tituloTela="Cadastrar Pessoa",vm.acao="Cadastrar",vm.idPessoa=f.idPessoa,vm.listar(vm.urlPerfil).then(function(a){void 0!==a&&(vm.listaPerfil=a,vm.idPessoa&&(vm.tituloTela="Editar Pessoa",vm.acao="Editar",vm.recuperarObjetoPorIDURL(vm.idPessoa,vm.urlPessoa).then(function(a){void 0!==a&&(vm.pessoa=a,vm.pessoa.dataNascimento=vm.formataDataTela(a.dataNascimento),vm.perfil=vm.pessoa.perfils)})))})},vm.cancelar=function(){vm.retornarTelaListagem()},vm.retornarTelaListagem=function(){c.path("listarPessoas")},vm.abrirModal=function(a){vm.enderecoModal=vm.enderecoDefault,void 0!==a&&(vm.enderecoModal=a),0===vm.pessoa.enderecos.length&&vm.pessoa.enderecos.push(vm.enderecoModal),$("#modalEndereco").modal()},vm.limparTela=function(){$("#modalEndereco").modal("toggle"),vm.endereco=void 0},vm.incluir=function(){vm.pessoa.imagem=document.getElementById("imagemPessoa").getAttribute("src"),document.getElementById("imagemPessoa").src=vm.pessoa.imagem;var a=angular.copy(vm.pessoa,vm.endereco);a.dataNascimento=vm.formataDataJava(vm.pessoa.dataNascimento),console.log(a.dataNascimento);var b=[];if(angular.forEach(a.enderecos,function(c,d){c.complemento.length>0&&(c.idPessoa=a.id,b.push(angular.copy(c)))}),a.enderecos=b,null!==vm.perfil){var c=!0;angular.forEach(a.perfils,function(a,b){a.id===vm.perfil.id&&(c=!1)}),c&&(a.perfils=vm.perfil)}"Cadastrar"==vm.acao?vm.salvar(vm.urlPessoa,a).then(function(a){vm.retornarTelaListagem()}):"Editar"==vm.acao&&vm.alterar(vm.urlPessoa,a).then(function(a){vm.retornarTelaListagem()}),document.getElementById("imagemPessoa").src=""},vm.remover=function(a,b){var c=vm.urlPessoa+a.id;"ENDERECO"===b&&(c=vm.urlEndereco+a.id),vm.excluir(c).then(function(a){vm.retornarTelaListagem()})},vm.recuperarObjetoPorIDURL=function(a,b){var c=d.defer();return g.listarId(b+a).then(function(a){void 0!==a.data?c.resolve(a.data):c.resolve(vm.enderecoDefault)}),c.promise},vm.listar=function(a){var b=d.defer();return g.listar(a).then(function(a){void 0!==a.data&&b.resolve(a.data)}),b.promise},vm.salvar=function(a,b){var c=d.defer(),e=JSON.stringify(b);return g.incluir(a,e).then(function(a){200==a.status&&c.resolve(a.data)}),c.promise},vm.alterar=function(a,b){var c=d.defer(),e=JSON.stringify(b);return g.alterar(a,e).then(function(a){200==a.status&&c.resolve(a.data)}),c.promise},vm.excluir=function(a,b){var c=d.defer();return g.excluir(a).then(function(a){200==a.status&&c.resolve(a.data)}),c.promise},vm.visualizarImg=function(){var a=document.querySelectorAll("img").item(0),b=document.querySelector("input[type=file").files[0],c=new FileReader;c.onloadend=function(){a.src=c.result},b?c.readAsDataURL(b):a.src=""},vm.obterEnderecoPorCep=function(){8===vm.enderecoModal.cep.length&&g.listar(vm.urlObterEnderecoPorCep+vm.enderecoDefault.cep).then(function(a){void 0===a.data.erro?(vm.enderecoDefault.uf=a.data.uf,vm.enderecoDefault.localidade=a.data.localidade,vm.enderecoDefault.bairro=a.data.bairro,vm.enderecoDefault.logradouro=a.data.logradouro):alert("CEP INV√ÅLIDO")}),vm.formataDataJava=function(a){var b=a.slice(0,2),c=a.slice(2,4);return a.slice(4,8)+"-"+c+"-"+b},vm.formataDataTela=function(a){var b=a.slice(0,4),c=a.slice(5,7);return a.slice(8,10)+c+b},vm.listaUF=[{id:"RO",desc:"RO"},{id:"AC",desc:"AC"},{id:"AM",desc:"AM"},{id:"RR",desc:"RR"},{id:"PA",desc:"PA"},{id:"AP",desc:"AP"},{id:"TO",desc:"TO"},{id:"MA",desc:"MA"},{id:"PI",desc:"PI"},{id:"CE",desc:"CE"},{id:"RN",desc:"RN"},{id:"PB",desc:"PB"},{id:"PE",desc:"PE"},{id:"AL",desc:"AL"},{id:"SE",desc:"SE"},{id:"BA",desc:"BA"},{id:"MG",desc:"MG"},{id:"ES",desc:"ES"},{id:"RJ",desc:"RJ"},{id:"SP",desc:"SP"},{id:"PR",desc:"PR"},{id:"SC",desc:"SC"},{id:"RS",desc:"RS"},{id:"MS",desc:"MS"},{id:"MT",desc:"MT"},{id:"GO",desc:"GO"},{id:"DF",desc:"DF"}]}}angular.module("hackaton-stefanini").controller("PessoaIncluirAlterarController",PessoaIncluirAlterarController),PessoaIncluirAlterarController.$inject=["$rootScope","$scope","$location","$q","$filter","$routeParams","HackatonStefaniniService"];